<!DOCTYPE html>
<html>  
  <head>
    <meta charset=utf-8>
    <h1>WebSockets Client Test Page</h1>
    <script src='FmCore.js'></script>   
    <script src='WsConnection.js'></script>   
    <script src='WsClient.js'></script>
  </head>
  <body>
    <script>
      (function(global, $) {
        var client = $.fm.ws.makeClient('perry', 17500, 'ws-server', {
          onError: function(error) {
            global.console.log('Connection Error: ' + error);            
          },
          onClose: function() {
            global.console.log('Connection closed.');            
          }
        });
        
        client.defReceiver('connectionAcknowledged', function(connectionId) {
          global.console.log('Connection Id: ' + connectionId);           
        });
        client.defRequest('wsSuccess');
        client.defRequest('wsError');        
        global.onload = function() {
          global.alert('WsClient');
          client.open();
          client.wsSuccess(42, {
            onSuccess: function(result) {
              global.console.log('onSuccess: ' + result);            
            },
            onFailure: function(error) {
              global.console.log('onFailure: ' + error.message);            
            }            
          });
          client.wsError(42, {
            onSuccess: function(result) {
              global.console.log('onSuccess: ' + result);            
            },
            onFailure: function(error) {
              global.console.log('onFailure: ' + error.message);            
            }            
          });
        };
      })(this, (this.jQuery || this));
    </script>   
  </body>
</html>
